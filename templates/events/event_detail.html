{% extends "base.html" %}
{% block title %}{{ event.title }}{% endblock %}

{% block content %}
<div class="card mt-4">
  <div class="card-header">
    <h2>{{ event.title }}</h2>
  </div>
  <div class="card-body">
    <p><strong>Описание:</strong> {{ event.description }}</p>
    <p><strong>Дата:</strong> {{ event.date|date:"d.m.Y" }}</p>
    <p><strong>Капацитет:</strong> {{ event.capacity }}</p>
    <p><strong>Свободни места:</strong> {{ event.available_seats }}</p>
    <p><strong>Категория:</strong> {{ event.get_category_display }}</p>
    <p><strong>Организация:</strong> {{ event.organization.name }}</p>
    <p><strong>Локация:</strong> {{ event.location.name }}, {{ event.location.city }}</p>
  </div>

  <div class="card-footer d-flex justify-content-between">
    <a href="{% url 'events:event-list' %}" class="btn btn-secondary">Обратно</a>

    <div class="d-flex gap-2">
      {% if user.is_authenticated and user == event.organization.user %}
        <a href="{% url 'events:event-update' event.pk %}" class="btn btn-primary">Редактирай</a>
        <a href="{% url 'events:event-delete' event.pk %}" class="btn btn-danger">Изтрий</a>
      {% endif %}

      {% if user.is_authenticated and user != event.organization.user %}
        {% if has_joined %}
          <button class="btn btn-secondary" disabled>Присъединен</button>
        {% elif event.available_seats|add:0 > 0 %}
          <a href="{% url 'applications:application-create' event.pk %}" class="btn btn-success">Присъедини се</a>
        {% else %}
          <button class="btn btn-outline-secondary" disabled>Няма места</button>
        {% endif %}
      {% elif not user.is_authenticated %}
        <a class="btn btn-outline-primary" href="{% url 'accounts:login' %}?next={{ request.path }}">
          Влез, за да се присъединиш
        </a>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
